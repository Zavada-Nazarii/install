# üìò Unbound ‚Äî –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ DNS –¥–ª—è —Å–∞–±–¥–æ–º–µ–Ω-—Ä–µ–∫–æ–Ω—É

---

## üß© –©–æ —Ç–∞–∫–µ Unbound?

**Unbound** ‚Äî —Ü–µ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–∏–π, —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∏–π DNS-—Ä–µ–ª–µ–≤–∞–Ω—Ç, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î:
- –Ω–∞–ø—Ä—è–º—É –∑–≤–µ—Ä—Ç–∞—Ç–∏—Å—å –¥–æ root, TLD —Ç–∞ –∞–≤—Ç–æ—Ä–∏—Ç–∞—Ç–∏–≤–Ω–∏—Ö DNS
- —É–Ω–∏–∫–∞—Ç–∏ throttling/block –≤—ñ–¥ Google DNS, Cloudflare DNS —Ç–æ—â–æ
- –∫–µ—à—É–≤–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Ç–∞ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∞–≤—Ç–æ–Ω–æ–º–Ω–æ

> –í—ñ–Ω —î —ñ–¥–µ–∞–ª—å–Ω–∏–º –¥–ª—è –º–∞—Å–æ–≤–∏—Ö DNS-—Ä–µ–∑–æ–ª–≤—ñ–≤ —É —Å–∞–±–¥–æ–º–µ–Ω-—Ä–µ–∫–æ–Ω—ñ

---

## üîç –î–ª—è —á–æ–≥–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–∏–π DNS –∑–∞–º—ñ—Å—Ç—å –ø—É–±–ª—ñ—á–Ω–∏—Ö —Ä–µ–∑–æ–ª–≤–µ—Ä—ñ–≤?

| –ü—Ä–æ–±–ª–µ–º–∞ –∑ –ø—É–±–ª—ñ—á–Ω–∏–º–∏ DNS (1.1.1.1 / 8.8.8.8) | –†—ñ—à–µ–Ω–Ω—è –∑ –ª–æ–∫–∞–ª—å–Ω–∏–º DNS (Unbound) |
|----------------------------------------------|-----------------------------------|
| Rate-limiting (–ø—ñ—Å–ª—è –∫—ñ–ª—å–∫–æ—Ö —Ç–∏—Å—è—á –∑–∞–ø–∏—Ç—ñ–≤)  | –í—ñ–¥—Å—É—Ç–Ω—ñ–π                         |
| Wildcard-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ –∞–±–æ —Ä–µ–¥–∏—Ä–µ–∫—Ç–∏ CDN        | –ó–∞–≤–∂–¥–∏ —Ç–æ—á–Ω—ñ authoritative-–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ |
| –ë–ª–æ–∫—É–≤–∞–Ω–Ω—è VPS                                | –ë–∞–π–ø–∞—Å —á–µ—Ä–µ–∑ 127.0.0.1             |
| –ù–µ–º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ NXDOMAIN              | –ü–æ–≤–Ω–∞ –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ NXDOMAIN           |
| –¢—Ä–∞—Ñ—ñ–∫ –≤–∏–¥–Ω–æ —Ç—Ä–µ—Ç—ñ–º —Å—Ç–æ—Ä–æ–Ω–∞–º                  | –ü–æ–≤–Ω–∞ –ª–æ–∫–∞–ª—ñ–∑–∞—Ü—ñ—è                  |

---

## ‚öôÔ∏è –ü—Ä–∏–Ω—Ü–∏–ø —Ä–æ–±–æ—Ç–∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ DNS (Unbound)

Unbound –ø—Ä–∞—Ü—é—î —è–∫ –ø–æ–≤–Ω–æ—Ü—ñ–Ω–Ω–∏–π recursive resolver. –û—Å—å –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å, —è–∫ –≤—ñ–Ω –ø–µ—Ä–µ–≤—ñ—Ä—è—î –¥–æ–º–µ–Ω:

```text
  –¢–∏ –ø–µ—Ä–µ–≤—ñ—Ä—è—î—à: sub.example.com

  [1] –ó–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ root-—Å–µ—Ä–≤–µ—Ä–∞ (a.root-servers.net):
      ‚Üí "–•—Ç–æ –æ–±—Å–ª—É–≥–æ–≤—É—î .com?"

  [2] –û—Ç—Ä–∏–º—É—î NS-—Å–µ—Ä–≤–µ—Ä–∏ –¥–ª—è .com-–∑–æ–Ω–∏

  [3] –ó–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ NS-—Å–µ—Ä–≤–µ—Ä—ñ–≤ .com:
      ‚Üí "–•—Ç–æ –æ–±—Å–ª—É–≥–æ–≤—É—î example.com?"

  [4] –û—Ç—Ä–∏–º—É—î –∞–≤—Ç–æ—Ä–∏—Ç–∞—Ç–∏–≤–Ω—ñ NS-—Å–µ—Ä–≤–µ—Ä–∏ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, ns1.example.com)

  [5] –ó–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –¥–æ ns1.example.com:
      ‚Üí "–ß–∏ —ñ—Å–Ω—É—î sub.example.com?"

  [6] –û—Ç—Ä–∏–º—É—î:
      ‚Üí A-–∑–∞–ø–∏—Å –∞–±–æ ‚Üí NXDOMAIN
```

‚úÖ –£—Å—è —Ü—è —ñ—î—Ä–∞—Ä—Ö—ñ—è –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è **–ª–æ–∫–∞–ª—å–Ω–æ**, –±–µ–∑ —Å—Ç–æ—Ä–æ–Ω–Ω—ñ—Ö DNS.

---

## üì¶ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Unbound (Ubuntu/Debian)

```bash
sudo apt update && sudo apt install unbound -y
```

---

## üìÅ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è root hints (–æ–±–æ–≤'—è–∑–∫–æ–≤–æ)

```bash
curl -o /var/lib/unbound/root.hints https://www.internic.net/domain/named.cache
```

---

## üõ†Ô∏è –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è `/etc/unbound/unbound.conf`

```conf
server:
  verbosity: 1
  interface: 127.0.0.1
  access-control: 127.0.0.1/8 allow

  # –ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
  num-threads: 4
  msg-cache-size: 100m
  rrset-cache-size: 100m
  cache-min-ttl: 300
  cache-max-ttl: 86400
  prefetch: yes
  prefetch-key: yes

  # IPv6 –º–æ–∂–Ω–∞ –≤–∏–º–∫–Ω—É—Ç–∏, —è–∫—â–æ –Ω–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω
  do-ip6: no

  # –û–±–º–µ–∂–µ–Ω–Ω—è
  do-not-query-localhost: no

  # –ó–±—ñ–ª—å—à–µ–Ω–Ω—è –ª—ñ–º—ñ—Ç—ñ–≤
  outgoing-range: 8192
  num-queries-per-thread: 4096
  so-rcvbuf: 4m
  so-sndbuf: 4m

  # –†–µ–∫—É—Ä—Å—ñ—è –Ω–∞–ø—Ä—è–º—É –¥–æ root DNS
  harden-glue: yes
  harden-dnssec-stripped: yes
  unwanted-reply-threshold: 10000000
  module-config: "iterator"
# Root hints (–∞–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω—ñ root-—Å–µ—Ä–≤–µ—Ä–∏)
root-hints: "/var/lib/unbound/root.hints"
```

> –ü–µ—Ä–µ–≤—ñ—Ä –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é
```bash
sudo unbound-checkconf
```

> `module-config: "iterator"` –≤–∏–º–∏–∫–∞—î DNSSEC, —è–∫–∏–π –º–æ–∂–µ —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç–∏

> –ü–æ–º–∏–ª–∫–∏ ? —à—É–∫–∞—î–º–æ —ñ –¥–µ–±–∞–∂–∏–º–æ
```bash
sudo journalctl -u unbound --no-pager | tail -n 50
```

---

## üöÄ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–∞ –∑–∞–ø—É—Å–∫

```bash
sudo unbound-checkconf
sudo systemctl restart unbound
sudo systemctl enable unbound
```

---

## üß™ –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ DNS

```bash
dig example.com @127.0.0.1 +short
```

> –ú–∞—î –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ IP, –Ω–∞–ø—Ä.: `93.184.216.34`

---

## üß∞ –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑ puredns

```bash
puredns resolve domains.txt \
  --resolvers <(echo 127.0.0.1) \
  --write verified.txt
```

–∞–±–æ —á–µ—Ä–µ–∑ Python-—Å–∫—Ä–∏–ø—Ç:
```bash
python3 puredns_verify_recursive.py --local
```

---

## ‚úÖ –í–∏—Å–Ω–æ–≤–æ–∫

> –õ–æ–∫–∞–ª—å–Ω–∏–π DNS —á–µ—Ä–µ–∑ Unbound ‚Äî —Ü–µ —Å—Ç–∞–±—ñ–ª—å–Ω–∏–π, —Ç–æ—á–Ω–∏–π —ñ —à–≤–∏–¥–∫–∏–π —Å–ø–æ—Å—ñ–± –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –º—ñ–ª—å–π–æ–Ω—ñ–≤ —Å–∞–±–¥–æ–º–µ–Ω—ñ–≤ –±–µ–∑ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –≤—ñ–¥ –ø—É–±–ª—ñ—á–Ω–∏—Ö DNS.

–Ü–¥–µ–∞–ª—å–Ω–æ –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è:
- recon-–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó
- —Ç–æ—á–Ω–æ–≥–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è wildcard'—ñ–≤
- –±–µ–∑–ø–µ—á–Ω–æ—ó —Ä–æ–±–æ—Ç–∏ –≤ —Ö–º–∞—Ä–∞—Ö

---

–ì–æ—Ç–æ–≤–∏–π –¥–æ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –≤ –±—É–¥—å-—è–∫–∏–π recon-–ø–∞–π–ø–ª–∞–π–Ω.

